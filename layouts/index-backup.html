{{- define "main" }}

{{- /* Hero Search Section */ -}}
<section class="hero-search">
    <div class="search-container">
        <h1 class="hero-title">Explore the Linux Universe</h1>
        <p class="hero-tagline">{{ site.Params.description }}</p>
        <div class="search-box">
            <input type="text" id="search-input" placeholder="Search Linux tutorials or tools..." />
            <button type="button" id="search-btn" aria-label="Search">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
            </button>
        </div>
    </div>
</section>

{{- /* Featured Article Section */ -}}
{{- $featured := first 1 (where .Site.RegularPages "Section" "posts") }}
{{- if eq (len $featured) 0 }}
    {{- $featured = first 1 (where .Site.RegularPages "Section" "tutorials") }}
{{- end }}
{{- if eq (len $featured) 0 }}
    {{- $featured = first 1 .Site.RegularPages }}
{{- end }}
{{- if gt (len $featured) 0 }}
{{- range $featured }}
<section class="featured-article">
    <div class="section-header">
        <h2>Featured Article</h2>
    </div>
    <article class="featured-card">
        {{- if .Params.cover.image }}
        <div class="featured-image">
            <img src="{{ .Params.cover.image }}" alt="{{ .Title }}" loading="lazy">
        </div>
        {{- end }}
        <div class="featured-content">
            <div class="featured-meta">
                <span class="category">{{ .Section | title }}</span>
                <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
            </div>
            <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
            <p class="featured-summary">{{ .Summary | plainify | truncate 150 }}</p>
            <a href="{{ .Permalink }}" class="read-more-btn">Read More</a>
        </div>
    </article>
</section>
{{- end }}
{{- else }}
<section class="featured-article">
    <div class="section-header">
        <h2>Featured Article</h2>
    </div>
    <p>No content available.</p>
</section>
{{- end }}

{{- /* Latest Posts Section */ -}}
<section class="latest-posts">
    <div class="section-header">
        <h2>Latest Content</h2>
        <a href="/posts/" class="view-all">View All Posts</a>
    </div>
    <div class="posts-grid">
        {{- $posts := first 6 (where .Site.RegularPages "Section" "posts") }}
        {{- if eq (len $posts) 0 }}
            {{- $posts = first 6 (where .Site.RegularPages "Section" "tutorials") }}
        {{- end }}
        {{- if eq (len $posts) 0 }}
            {{- $posts = first 6 .Site.RegularPages }}
        {{- end }}
        {{- range $posts }}
        <article class="post-card">
            <div class="post-meta">
                <span class="category">{{ .Section | title }}</span>
                <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Jan 2" }}</time>
            </div>
            <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
            <p class="post-summary">{{ .Summary | plainify | truncate 100 }}</p>
            <a href="{{ .Permalink }}" class="read-more">Read More</a>
        </article>
        {{- end }}
    </div>
</section>

{{- /* Popular Tools Section */ -}}
<section class="popular-tools">
    <div class="section-header">
        <h2>Popular Linux Tools</h2>
        <a href="/tools/" class="view-all">Explore All Tools</a>
    </div>
    <div class="tools-grid">
        {{- range site.Data.tools }}
        <div class="tool-card">
            <h4>{{ .name }}</h4>
            <p class="tool-description">{{ .description }}</p>
            <code class="tool-example">{{ .example }}</code>
            <div class="tool-meta">
                <span class="difficulty {{ .difficulty }}">{{ .difficulty | title }}</span>
            </div>
        </div>
        {{- end }}
    </div>
</section>

{{- /* Community Section */ -}}
<section class="community-picks">
    <div class="section-header">
        <h2>Community Resources</h2>
    </div>
    <div class="community-grid">
        {{- range site.Data.community }}
        <div class="community-card">
            <h4><a href="{{ .url }}" target="_blank" rel="noopener">{{ .title }}</a></h4>
            <p>{{ .description }}</p>
            <span class="community-type">{{ .type | title }}</span>
        </div>
        {{- end }}
    </div>
</section>

{{- /* Newsletter Subscription */ -}}
<section class="newsletter">
    <div class="newsletter-container">
        <h2>Stay Updated</h2>
        <p>Get the latest Linux tutorials and tips delivered to your inbox</p>
        <form class="newsletter-form" action="#" method="post">
            <input type="email" placeholder="Enter your email address" required>
            <button type="submit">Subscribe</button>
        </form>
    </div>
</section>

{{- end }}