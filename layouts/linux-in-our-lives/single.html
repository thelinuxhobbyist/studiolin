{{- define "main" }}

<div class="post-single-container">
	<article class="post-single">
		<header class="post-header">
			<div class="breadcrumbs">
				<a href="/">Home</a> →
				<a href="/linux-in-our-lives/">Linux in Our Lives</a>
			</div>
			<h1 class="post-title">{{ .Title }}</h1>
			<div class="post-meta">
				{{ with .Params.author }}<span>{{ . }}</span> • {{ end }}
				<time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
					{{ .Date.Format "January 2, 2006" }}
				</time>
				<span class="reading-time">{{ .ReadingTime }} min read</span>
			</div>
		</header>

		{{/* Featured image (page-bundled or fallback) */}}
		<div class="post-featured-image">
			{{ partial "featured-image.html" (dict "page" . "class" "post-featured" "alt" .Title) }}
		</div>

		<div class="post-content">
			{{- $content := .Content -}}
			{{ $content | safeHTML }}
		</div>
		
		{{- if .Params.tags }}
		<footer class="post-footer">
			<div class="post-tags-footer">
				<h4>Tags:</h4>
				{{- range .Params.tags }}
				<a href="/tags/{{ . | urlize }}/" class="tag-link">{{ . }}</a>
				{{- end }}
			</div>
		</footer>
		{{- end }}
	</article>
	
	{{- /* Related Posts Section */ -}}
	<section class="related-posts">
		<h3>You Might Also Like</h3>
		<div class="related-posts-grid">
			{{- $related := (where .Site.RegularPages "Section" .Section | shuffle | first 4) }}
			{{- range $related }}
			{{- if ne .Permalink $.Permalink }}
			<article class="related-post-card">
				<h4><a href="{{ .Permalink }}">{{ .Title }}</a></h4>
				<div class="related-meta">
					<time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
					<span class="read-time">{{ .ReadingTime }} min read</span>
				</div>
				<p class="related-excerpt">{{ .Summary | plainify | truncate 100 }}</p>
				<a href="{{ .Permalink }}" class="read-more-link">Read More →</a>
			</article>
			{{- end }}
			{{- end }}
		</div>
	</section>
</div>

{{- end }}