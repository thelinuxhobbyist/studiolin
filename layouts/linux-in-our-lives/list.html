{{- define "main" }}

<section class="blog-hero hero-bg-full">
    <h1 class="blog-hero-title">{{ .Title }}</h1>
    <p class="blog-hero-desc">{{ .Params.description | default "Explore how Linux impacts the world—from education to enterprise—through insightful articles and stories." }}</p>
</section>

{{/* Intro Paragraph */}}
<section class="section-intro">
    <div class="intro-container">
        <p>This section collects all our editorial content exploring Linux's impact across five key areas: government & policy, education & learning, enterprise & business, community & open source, and everyday life. Browse by category below or explore the dedicated pillar pages for deeper dives into each topic.</p>
    </div>
</section>

{{/* Define our main categories */}}
{{- $categories := dict 
    "Education" "education"
    "Government" "government"
    "Business & Enterprise" "business"
    "Personal Computing" "personal"
    "Community & Open Source" "community"
}}

{{/* Sector Navigation */}}
<nav class="sector-nav">
    <div class="sector-nav-container">
        <a href="/linux-in-our-lives/" class="sector-filter-btn active">All</a>
        <a href="/linux-in-government/" class="sector-filter-btn">Government</a>
        <a href="/linux-in-education/" class="sector-filter-btn">Education</a>
        <a href="/linux-in-enterprise/" class="sector-filter-btn">Business & Enterprise</a>
        <a href="/linux-in-everyday-life/" class="sector-filter-btn">Personal Computing</a>
        <a href="/linux-in-community/" class="sector-filter-btn">Community & Open Source</a>
    </div>
</nav>

{{/* Get all posts from both posts and linux-in-our-lives sections */}}
{{- $postsPosts := where .Site.RegularPages "Section" "posts" }}
{{- $linuxPosts := where .Site.RegularPages "Section" "linux-in-our-lives" }}
{{- $allPosts := union $postsPosts $linuxPosts }}

{{/* Loop through each category and display its posts */}}
{{- range $title, $key := $categories }}
    {{/* Filter posts for this category */}}
    {{- $categoryPosts := where $allPosts "Params.categories" "intersect" (slice $title) }}
    
    <section class="sector-section" id="sector-{{ $key }}" data-sector="{{ $key }}">
        <div class="sector-header">
            <h2 class="sector-title">{{ $title }}</h2>
            {{/* Only show view all if there are more than 6 posts */}}
            {{- if gt (len $categoryPosts) 6 }}
                <a href="#" class="view-all-btn" data-category="{{ $key }}">View All →</a>
            {{- end }}
        </div>
        <div class="blog-list" data-sector-list="{{ $key }}">
            {{- $hasPosts := false }}
            {{- range $index, $post := first 6 $categoryPosts }}
                {{- $hasPosts = true }}
                <article class="blog-card" data-sector="{{ $key }}">
                    <div class="blog-card-content">
                        <div class="blog-card-meta">
                            <time datetime="{{ $post.Date.Format "2006-01-02" }}">{{ $post.Date.Format "January 2, 2006" }}</time>
                            {{- with $post.Params.tags }}
                            <div class="blog-card-tags">
                                {{- range first 3 . }}
                                <span class="tag">#{{ . }}</span>
                                {{- end }}
                            </div>
                            {{- end }}
                        </div>
                        <h3 class="blog-card-title"><a href="{{ $post.RelPermalink }}">{{ $post.Title }}</a></h3>
                        <div class="blog-card-summary">{{ .Summary | plainify }}</div>
                        <a href="{{ $post.RelPermalink }}" class="read-more">Read Full Article →</a>
                    </div>
                </article>
            {{- end }}
            {{- if not $hasPosts }}
                <p class="no-posts">No articles in this category yet. Check back soon!</p>
            {{- end }}
        </div>

        {{- if gt (len $categoryPosts) 6 }}
        <div class="load-more-container">
            <button class="load-more-btn" data-sector="{{ $key }}">Load More ({{ sub (len $categoryPosts) 6 }} more)</button>
        </div>
        {{- end }}
</section>
{{- end }}
<style>
.hero-bg-full {
	width: 100vw;
	position: relative;
	left: 50%;
	right: 50%;
	margin-left: -50vw;
	margin-right: -50vw;
	background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
	color: #fff;
	padding: 3rem 2rem 2.5rem 2rem;
	margin-bottom: 2rem;
	text-align: center;
}
.blog-hero-title {
	font-size: 2.3rem;
	margin-bottom: 0.5rem;
	color: #fff !important;
}
.blog-hero-desc {
	font-size: 1.15rem;
	color: #fff !important;
	margin-bottom: 2rem;
}

/* Intro Section */
.section-intro {
	background: #f8fafc;
	border-top: 1px solid #e2e8f0;
	border-bottom: 1px solid #e2e8f0;
	padding: 2rem 1rem;
	margin-bottom: 3rem;
}

.intro-container {
	max-width: 850px;
	margin: 0 auto;
}

.section-intro p {
	font-size: 1.05rem;
	line-height: 1.7;
	color: #475569;
	margin: 0;
	text-align: center;
}

/* Sector Sections */.sector-nav {
	background: #f6f8fa;
	padding: 1.5rem 0;
	margin-bottom: 3rem;
	border-top: 1px solid #e2e8f0;
	border-bottom: 1px solid #e2e8f0;
	position: sticky;
	top: 0;
	z-index: 100;
}
.sector-nav-container {
	max-width: 1000px;
	margin: 0 auto;
	display: flex;
	gap: 1rem;
	flex-wrap: wrap;
	justify-content: center;
	padding: 0 1rem;
}
.sector-filter-btn {
	background: #fff;
	border: 2px solid #e2e8f0;
	border-radius: 6px;
	padding: 0.6rem 1.2rem;
	font-size: 0.95rem;
	font-weight: 600;
	color: #475569;
	cursor: pointer;
	transition: all 0.2s;
}
.sector-filter-btn:hover {
	border-color: #2563eb;
	color: #2563eb;
}
.sector-filter-btn.active {
	background: #2563eb;
	border-color: #2563eb;
	color: #fff;
}
.sector-section {
	max-width: 1000px;
	margin: 0 auto 5.5rem auto;
	padding: 0 1rem;
}
.sector-section.hidden {
	display: none;
}
.sector-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 1.5rem;
}
.sector-title {
	font-size: 1.8rem;
	font-weight: 700;
	color: #1e293b;
	padding-bottom: 0.5rem;
	border-bottom: 3px solid #2563eb;
	margin: 0;
}
.view-all-btn {
	background: #2563eb;
	color: #fff;
	padding: 0.6rem 1.2rem;
	border-radius: 6px;
	text-decoration: none;
	font-weight: 600;
	font-size: 0.95rem;
	transition: background 0.2s;
	white-space: nowrap;
}
.view-all-btn:hover {
	background: #1d4ed8;
	text-decoration: none;
}
.load-more-container {
	text-align: center;
	margin-top: 2rem;
}
.load-more-btn {
	background: #fff;
	border: 2px solid #2563eb;
	color: #2563eb;
	padding: 0.8rem 2rem;
	border-radius: 6px;
	font-weight: 600;
	font-size: 1rem;
	cursor: pointer;
	transition: all 0.2s;
}
.load-more-btn:hover {
	background: #2563eb;
	color: #fff;
}
.load-more-btn.hidden {
	display: none;
}
.blog-list {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
	gap: 1.5rem;
}
.blog-card {
	display: block;
	text-decoration: none;
	color: inherit;
	background: #fff;
	border: 1px solid #e2e8f0;
	border-radius: 8px;
	box-shadow: 0 2px 8px rgba(0,0,0,0.04);
	transition: box-shadow 0.2s, transform 0.2s;
	height: 100%;
}
.blog-card:hover {
	box-shadow: 0 6px 24px rgba(0,0,0,0.08);
	text-decoration: none;
	transform: translateY(-2px);
}
.blog-card-content {
	padding: 1.5rem;
}
.blog-card-title {
	font-size: 1.3rem;
	font-weight: 700;
	color: #1e293b;
	margin-bottom: 0.5rem;
	line-height: 1.3;
}
.blog-card-date {
	font-size: 0.9rem;
	color: #64748b;
	margin-bottom: 0.8rem;
}
.blog-card-summary {
	font-size: 0.95rem;
	color: #475569;
	line-height: 1.6;
}
.no-posts {
	color: #64748b;
	font-style: italic;
	text-align: center;
	padding: 2rem;
}
@media (max-width: 768px) {
	.blog-list {
		grid-template-columns: 1fr;
	}
	.sector-nav-container {
		gap: 0.5rem;
	}
	.sector-filter-btn {
		font-size: 0.85rem;
		padding: 0.5rem 0.9rem;
	}
}
</style>
<script src="/js/sector-filter.js"></script>
{{- end }}