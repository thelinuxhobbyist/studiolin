{{- define "main" }}

<section class="blog-hero hero-bg-full">
	<h1 class="blog-hero-title">{{ .Title }}</h1>
	<p class="blog-hero-desc">{{ .Params.description | default "Explore how Linux impacts the world—from infrastructure to personal freedom—through insightful articles and stories." }}</p>
</section>

{{/* Sector Navigation */}}
<nav class="sector-nav">
	<div class="sector-nav-container">
		<button class="sector-filter-btn active" data-sector="all">All</button>
		<button class="sector-filter-btn" data-sector="education">Education</button>
		<button class="sector-filter-btn" data-sector="government">Government</button>
		<button class="sector-filter-btn" data-sector="business">Business & Enterprise</button>
		<button class="sector-filter-btn" data-sector="personal">Personal Computing</button>
		<button class="sector-filter-btn" data-sector="community">Community & Open Source</button>
	</div>
</nav>

{{/* Build sector groups */}}
{{- $sectors := dict "education" "Education" "government" "Government" "business" "Business & Enterprise" "personal" "Personal Computing" "community" "Community & Open Source" }}

{{- range $sectorKey, $sectorName := $sectors }}
<section class="sector-section" id="sector-{{ $sectorKey }}" data-sector="{{ $sectorKey }}">
	<div class="sector-header">
		<h2 class="sector-title">{{ $sectorName }}</h2>
		<a href="/linux-in-our-lives/{{ $sectorKey }}/" class="view-all-btn">View All →</a>
	</div>
	<div class="blog-list" data-sector-list="{{ $sectorKey }}">
		{{- $posts := where $.Pages "Params.sector" $sectorKey }}
		{{- $posts = where $posts "Kind" "page" }}
		{{- $hasPosts := false }}
		{{- range $index, $post := $posts }}
			{{- if lt $index 6 }}
				{{- $hasPosts = true }}
				<a href="{{ $post.RelPermalink }}" class="blog-card" data-sector="{{ $post.Params.sector }}">
					<div class="blog-card-content">
						<h3 class="blog-card-title">{{ $post.Title }}</h3>
						<div class="blog-card-date">{{ $post.Date.Format "January 2, 2006" }}</div>
						<div class="blog-card-summary">{{ with $post.Params.excerpt }}{{ . }}{{ else }}{{ $post.Summary | plainify }}{{ end }}</div>
					</div>
				</a>
			{{- else }}
				<a href="{{ $post.RelPermalink }}" class="blog-card hidden-card" data-sector="{{ $post.Params.sector }}" style="display: none;">
					<div class="blog-card-content">
						<h3 class="blog-card-title">{{ $post.Title }}</h3>
						<div class="blog-card-date">{{ $post.Date.Format "January 2, 2006" }}</div>
						<div class="blog-card-summary">{{ with $post.Params.excerpt }}{{ . }}{{ else }}{{ $post.Summary | plainify }}{{ end }}</div>
					</div>
				</a>
			{{- end }}
		{{- end }}
		{{- if not $hasPosts }}
			<p class="no-posts">No articles in this sector yet. Check back soon!</p>
		{{- end }}
	</div>
	{{- if gt (len $posts) 6 }}
	<div class="load-more-container">
		<button class="load-more-btn" data-sector="{{ $sectorKey }}">Load More ({{ sub (len $posts) 6 }} more)</button>
	</div>
	{{- end }}
</section>
{{- end }}
<style>
.hero-bg-full {
	width: 100vw;
	position: relative;
	left: 50%;
	right: 50%;
	margin-left: -50vw;
	margin-right: -50vw;
	background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
	color: #fff;
	padding: 3rem 2rem 2.5rem 2rem;
	margin-bottom: 2rem;
	text-align: center;
}
.blog-hero-title {
	font-size: 2.3rem;
	margin-bottom: 0.5rem;
	color: #fff !important;
}
.blog-hero-desc {
	font-size: 1.15rem;
	color: #fff !important;
	margin-bottom: 2rem;
}
.sector-nav {
	background: #f6f8fa;
	padding: 1.5rem 0;
	margin-bottom: 3rem;
	border-top: 1px solid #e2e8f0;
	border-bottom: 1px solid #e2e8f0;
	position: sticky;
	top: 0;
	z-index: 100;
}
.sector-nav-container {
	max-width: 1000px;
	margin: 0 auto;
	display: flex;
	gap: 1rem;
	flex-wrap: wrap;
	justify-content: center;
	padding: 0 1rem;
}
.sector-filter-btn {
	background: #fff;
	border: 2px solid #e2e8f0;
	border-radius: 6px;
	padding: 0.6rem 1.2rem;
	font-size: 0.95rem;
	font-weight: 600;
	color: #475569;
	cursor: pointer;
	transition: all 0.2s;
}
.sector-filter-btn:hover {
	border-color: #2563eb;
	color: #2563eb;
}
.sector-filter-btn.active {
	background: #2563eb;
	border-color: #2563eb;
	color: #fff;
}
.sector-section {
	max-width: 1000px;
	margin: 0 auto 4rem auto;
	padding: 0 1rem;
}
.sector-section.hidden {
	display: none;
}
.sector-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 1.5rem;
}
.sector-title {
	font-size: 1.8rem;
	font-weight: 700;
	color: #1e293b;
	padding-bottom: 0.5rem;
	border-bottom: 3px solid #2563eb;
	margin: 0;
}
.view-all-btn {
	background: #2563eb;
	color: #fff;
	padding: 0.6rem 1.2rem;
	border-radius: 6px;
	text-decoration: none;
	font-weight: 600;
	font-size: 0.95rem;
	transition: background 0.2s;
	white-space: nowrap;
}
.view-all-btn:hover {
	background: #1d4ed8;
	text-decoration: none;
}
.load-more-container {
	text-align: center;
	margin-top: 2rem;
}
.load-more-btn {
	background: #fff;
	border: 2px solid #2563eb;
	color: #2563eb;
	padding: 0.8rem 2rem;
	border-radius: 6px;
	font-weight: 600;
	font-size: 1rem;
	cursor: pointer;
	transition: all 0.2s;
}
.load-more-btn:hover {
	background: #2563eb;
	color: #fff;
}
.load-more-btn.hidden {
	display: none;
}
.blog-list {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
	gap: 1.5rem;
}
.blog-card {
	display: block;
	text-decoration: none;
	color: inherit;
	background: #fff;
	border: 1px solid #e2e8f0;
	border-radius: 8px;
	box-shadow: 0 2px 8px rgba(0,0,0,0.04);
	transition: box-shadow 0.2s, transform 0.2s;
	height: 100%;
}
.blog-card:hover {
	box-shadow: 0 6px 24px rgba(0,0,0,0.08);
	text-decoration: none;
	transform: translateY(-2px);
}
.blog-card-content {
	padding: 1.5rem;
}
.blog-card-title {
	font-size: 1.3rem;
	font-weight: 700;
	color: #1e293b;
	margin-bottom: 0.5rem;
	line-height: 1.3;
}
.blog-card-date {
	font-size: 0.9rem;
	color: #64748b;
	margin-bottom: 0.8rem;
}
.blog-card-summary {
	font-size: 0.95rem;
	color: #475569;
	line-height: 1.6;
}
.no-posts {
	color: #64748b;
	font-style: italic;
	text-align: center;
	padding: 2rem;
}
@media (max-width: 768px) {
	.blog-list {
		grid-template-columns: 1fr;
	}
	.sector-nav-container {
		gap: 0.5rem;
	}
	.sector-filter-btn {
		font-size: 0.85rem;
		padding: 0.5rem 0.9rem;
	}
}
</style>
<script src="/js/sector-filter.js"></script>
{{- end }}